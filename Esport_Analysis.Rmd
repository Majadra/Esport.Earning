---
title: "Esport_Analysis"
author: "Ran K"
date: "7/14/2020"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggrepel)
library(scales)
knitr::opts_chunk$set(echo = TRUE)
```



<center><h2>Loading data</center></h2>
<br>

```{r Load Data}
df <- read.csv("EsportsEarnings_final.csv")

#Quick variable summary.
str(df)
```

<center><h2>Some variable manipulation</center></h2>


```{r Variable_manipulation_date,echo = TRUE}
# I would like to change the "Year" and "ReleaseDate" variables into date format

df$Date <- as.Date(df$Date)

#fixing a small error
df[which(df$ReleaseDate==11),"ReleaseDate"] <- 2011 #checked online
df$ReleaseDate <- paste0("01/01/",df$ReleaseDate)
df$ReleaseDate <- as.Date(df$ReleaseDate,format = "%d/%m/%Y")
```

```{r Variable_manipulation_genre,echo = TRUE}
# Creating a dataframe
df$Genre <- gsub(" Game","",df$Genre)
df$Genre[which(df$Genre == "Multiplayer Online Battle Arena")] <- "MOBA"
df$Genre[which(df$Genre == "Role-Playing")] <- "RPG"
df$Genre[which(df$Genre == "Third-Person Shooter")] <- "TPS"
df$Genre[which(df$Genre == "First-Person Shooter")] <- "FPS"
```

<center><h2> Explanetory Data Analysis</h2></center>
<br>

First of all, let's look at which games had the biggest amount of money distributed.

```{r Biggest_games,echo = TRUE}
# Creating a dataframe
Earnings_by_game <- df %>%
  group_by(Game,Genre,ReleaseDate) %>%
  summarise(Earnings = sum(Earnings),Tournaments = sum(Tournaments),Players = sum(Players))

# Ordering and keeping the 10 biggest games.
Earnings_by_game[order(Earnings_by_game$Earnings,decreasing = TRUE),][1:10,c(1:3,4,5)]

# Creating statistical summary of the earnings.
summary(Earnings_by_game$Earnings)
```
<br>
In the top 10 biggest games, there are no apparent surprises, we find **Dota 2**, **CS:GO**,**Fortnite**,**League of Legends**, and **Starcraft 2** at the top. <br>
Also, the data shows that the earnings are extremely right skewed, as the mean is almost 4 times the size of the median.<br>

**An important note**, all the information from this dataset comes from [EsportsEarnings](https://www.esportsearnings.com) ,this site gets its information by different people who document the different tournaments. As this is the case, it is highely like that there would be errors in documentation (I would assume these errors are more frequent in smaller tournaments and in tournaments that happened more then 10-15 years ago, when the Esports scene was a lot smaller). This means that we should take all the earnings data with a grain of salt and not as a definitive number. <br>

Now let's see which game had the most tournaments

```{r Most_tournaments,echo = TRUE}
# Ordering and keeping the 10 biggest games, tournament wise.
Earnings_by_game[order(Earnings_by_game$Tournaments,decreasing = TRUE),][1:10,c(1,4:6)]
```
<br>

It is not surprising that we find a similarity between the two lists: Dota 2, Starcraft 2, League of Legends and Counter-Strike: Global Offensive are all in the top 10 in prizepool earnings. <br>
What is somewhat interaesting is the fact that we have 3 different Super Smash Bros games, all in the top 10, this is while being not as big in the matter of prize pools (1.2M, 1.5M and 3.1M). <br>


Let's take a deeper look at the data - <br>
First, let's look at how the earnings developped through the years.

```{r Earning_timeseries,echo = FALSE}
#Disabling scientific annotation
options(scipen = 100)

# Creating a dataframe
Earning_timeseries <- df %>% select(Earnings,Date) %>% filter(Earnings > 0) %>% group_by(Date) %>% summarise(Earnings = sum(Earnings))
Earning_timeseries$Year <- format(Earning_timeseries$Date,"%Y")

# Plotting
ggplot(data = Earning_timeseries,aes(x = Date, y = Earnings)) +
  geom_line(color = "Red") +
  theme(legend.position = "bottom") +
  scale_y_continuous(labels = label_number(scale = 1/1000000)) +
  scale_x_date(date_labels = "%Y", date_breaks = "2 years") +
  labs(title = "Esport monthly earnings", subtitle = "In millions of dollars", y = "Earnings") +
  theme_classic() +
  geom_hline(yintercept = 0, linetype="dashed")

# Plotting yearly earnings
ggplot(data = Earning_timeseries %>%
         group_by(Year) %>%
         summarise(Earnings_in_millions = round((sum(Earnings)/1000000),1)),aes(x = Year, y = Earnings_in_millions)) +
  geom_bar(stat = "Identity", fill = "lightblue") +
  geom_text(aes(label = Earnings_in_millions),
            vjust = -0.3,hjust = 0.55, size = 3.5) +
  theme_classic() +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.text.x = element_text(angle=90)) + 
  labs(title = "Earnings by year", subtitle = "In millions of dollars", y = element_blank())

```
<br>

We can see that the Esports industry picked up towards 2011 - 2012, reaching a whopping 228.9 miliion dollar in prizes distributed in 2019. <br>
*It is important to note that 2020 is not finished and this is why the earnings are low. <br><br>

Let's look at the diffrenet genres <br>

```{r A_look_at_genres,echo = FALSE}
# Creating the dataframes

# Creating Earnings_by_genre
Earnings_by_genre <- Earnings_by_game %>%
  group_by(Genre) %>%
  summarise(Total_earnings = round(sum(Earnings)/1000000,2),
            Average_earnings = round(mean(Earnings)/1000,2),
            Median_Earnings = round(median(Earnings)/1000,2),
            Number_of_games = n())

# Creating Earnings_by_releasedate
Earnings_by_releasedate <- Earnings_by_game %>%
  group_by(ReleaseDate) %>%
  summarise(Total_earnings = round(sum(Earnings)/1000000,2),
            Average_earnings = round(mean(Earnings)/1000,2),
            Median_Earnings = round(median(Earnings)/1000,2),
            Number_of_games = n())
```


``` {r Total_earnings_per_genre,echo = FALSE}
# Plotting
ggplot(data = Earnings_by_genre,aes(x = Genre,y = Total_earnings, fill = Genre)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = Total_earnings),
            vjust = -0.3,hjust = 0.55, size = 3.5) +
  theme_classic() +
  theme(axis.text= element_blank(), axis.ticks = element_blank(), legend.position = "right") + 
  labs(title = "Total Earnings", subtitle = "In millions of dollars", y = element_blank(), x = element_blank())
```


``` {r Total_games_per_genre,echo = FALSE}
# Plotting
ggplot(data = Earnings_by_genre,aes(x = Genre,y = Number_of_games, fill = Genre)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = Number_of_games),
            vjust = -0.3,hjust = 0.55, size = 3.5) +
  theme_classic() +
  theme(axis.text= element_blank(), axis.ticks = element_blank(), legend.position = "right") + 
  labs(title = "Number of games per genre", y = element_blank(), x = element_blank())

```
 <br><br>
 We can see that there is no real relation between the number of games and the amount of money distributed in Esport tournaments. <br>
 
Now let's look at the release date, do games from a specific year had a biggest impact on the Esports industry?
 
``` {r Avg_earnings_per_releasedate, echo = FALSE}
# Creating a dataframe with the top 5 games for the annotations
top5 <- Earnings_by_game[order(Earnings_by_game$Earnings,decreasing = TRUE),][1:5,]
top5$Game[which(top5$Game == "Counter-Strike: Global Offensive")] <- "CS:GO"
top5$Game[which(top5$Game == "League of Legends")] <- "LOL"
top5$Game[which(top5$Game == "StarCraft II")] <- "SC2"


# Plotting
ggplot(data = Earnings_by_game,aes(x = ReleaseDate,y = Earnings,fill = Genre)) +
  geom_bar(stat = "identity",col = "Darkgrey") +
  theme_classic() +
  scale_y_continuous(labels = scales::label_number(scale = 1/1000000)) +
  labs(title = "Earnings by release date",subtitle = "In millions of dollars", y = element_blank(), x = element_blank()) +
  geom_text(aes(x = ReleaseDate, y = Earnings,label = Game), data = top5,size = 3.5)

```  
<br>
We can see that there is no real correlation between the release date of the game and the success it will have in the Esports scene.<br>
Also, we see that the vast majority of the disribution came from a fraction of the games (for example, almost all of the prize money which was for games in who were released in 2013 came from dota2, the same with 2009 and league of legends).<br>

Now it's time to dive in and do a little bit of feature engineering the retrieve some precius insight.

<center><h2>Feature engineering</h2></center>

In this part i'd like to create new variables which will help in the analysis process.

<h3>Creating **Franchise** variable</h3><br>
As a lot of the games are a part of a franchise containing several games, it may help us if we look at the date looking at the entire franchise, for example, let's take a look at the **Street - Fighter** franchise.<br>

```{r Street_Fighter_look,echo = TRUE, warning = FALSE}
# Creating a dataframe with games with a name containing the name "Street Fighter"
df_sf <- Earnings_by_game[which(grepl("[Ss]treet [Ff]ighter",Earnings_by_game$Game) == TRUE),]
df_sf
print(paste0("The number_of_games is ",nrow(df_sf),"and the total earnings for the franchise is ",sum(df_sf$Earnings)))

# Removing the df as it is unnecessary
rm(df_sf)

```
<br>
Ok, so the fact that a game is a part of a franchise **_does_** matter. In the case if the "Street Fighter" franchise, there are 15 games with earnings ranging from 350 to 220,000 dollars.<br>
It is fair to say that the entire franchise had destruted prizes in an amount of almost 560,000 dollars.<br>

To figure out which games are a part of which franchise, ill work with the __Earnings_per_game__ dataframe (as it has 1 observation per game, it is easier to work with) and use some regular expressions to find game titles which have identical words in it.

```{r franchise_search_5_words, warning = FALSE}

# At the start ill cast a large net, finding the first 5 words of each game.
# then filtering to find groups of 2 or more games with the same 5 first words in the title.
temp_5_words <- regexpr("^[[:graph:]]+\\s{1}[[:graph:]]+\\s{1}[[:graph:]]+\\s{1}[[:graph:]]+\\s{1}[[:graph:]]+",Earnings_by_game$Game)
temp_5_words <- data.frame(words = regmatches(Earnings_by_game$Game,temp_5_words))
temp_5_words <-  temp_5_words %>%group_by(words) %>% summarise(n=n())
temp_5_words <- temp_5_words %>% filter(n >1)
temp_5_words

# We already indentified a few franchises, ill put them in a new variable - "Franchise".

Earnings_by_game[which(grepl("Call of Duty",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Call of Duty"
Earnings_by_game[which(grepl("Guilty Gear",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Guilty Gear"
Earnings_by_game[which(grepl("Street Fighter",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Street Fighter"

# Removing the dataframe unnecessary 
rm(temp_5_words)
```
<br>

Now we move into the 4 words category, but at first we will need to filter out the games with a valid francise variable, ill put all the games that are left in another temporary dataframe - **Franchise_check**.

```{r franchise_search_4_words, warning = FALSE}

Franchise_check <- Earnings_by_game %>% filter(is.na(Franchise))
temp_4_words <- regexpr("^[[:graph:]]+\\s{1}[[:graph:]]+\\s{1}[[:graph:]]+\\s{1}[[:graph:]]+",Franchise_check$Game)
temp_4_words <- data.frame(words = regmatches(Franchise_check$Game,temp_4_words))
temp_4_words <- temp_4_words %>% group_by(words) %>% summarise(n=n())
temp_4_words <- temp_4_words %>% filter(n >1)
temp_4_words

# Continuing on and inserting more franchises.

Earnings_by_game[which(grepl("Dead or Alive",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Dead or Alive"
Earnings_by_game[which(grepl("Dengeki Bunko",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Dengeki Bunko"
Earnings_by_game[which(grepl("Melty Blood",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Melty Blood"
Earnings_by_game[which(grepl("Need for Speed",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Need for Speed"
Earnings_by_game[which(grepl("Under Night In-Birth",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Under Night In-Birth"

# Removing the dataframe unnecessary 
rm(temp_4_words)
```

I will do the same for 3, 2 and then one word (ill not present it to not clutter too much). <br>

```{r franchise_search_3_words, include = FALSE}

Franchise_check <- Earnings_by_game %>% filter(is.na(Franchise))
temp_3_words <- regexpr("^[[:graph:]]+\\s{1}[[:graph:]]+\\s{1}[[:graph:]]+",Franchise_check$Game)
temp_3_words <- data.frame(words = regmatches(Franchise_check$Game,temp_3_words))
temp_3_words <- temp_3_words %>% group_by(words) %>% summarise(n=n())
temp_3_words <- temp_3_words %>% filter(n >1)
temp_3_words

# Continuing on and inserting more franchises.

Earnings_by_game[which(grepl("Age of Empires",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Age of Empires"
Earnings_by_game[which(grepl("Arcana Heart",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Arcana Heart"
Earnings_by_game[which(grepl("BlazBlue",Earnings_by_game$Game) == TRUE),"Franchise"] <- "BlazBlue"
Earnings_by_game[which(grepl("Capcom vs. SNK",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Capcom vs. SNK"
Earnings_by_game[which(grepl("Gears of War",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Gears of War"
Earnings_by_game[which(grepl("King of Fighters",Earnings_by_game$Game) == TRUE),"Franchise"] <- "King of Fighters"
Earnings_by_game[which(grepl("Magic: The Gathering",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Magic: The Gathering"
Earnings_by_game[which(grepl("Marvel vs. Capcom",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Marvel vs. Capcom"
Earnings_by_game[which(grepl("Persona",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Persona"
Earnings_by_game[which(grepl("Pro Evolution Soccer",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Pro Evolution Soccer"
Earnings_by_game[which(grepl("Project Gotham Racing",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Project Gotham Racing"
Earnings_by_game[which(grepl("Rainbow Six",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Rainbow Six"
Earnings_by_game[which(grepl("Soul Calibur",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Soul Calibur"
Earnings_by_game[which(grepl("Super Smash Bros",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Super Smash Bros"
Earnings_by_game[which(grepl("Tekken ",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Tekken" #Left the space on purpose
Earnings_by_game[which(grepl("Virtua Fighter",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Virtua Fighter"
Earnings_by_game[which(grepl("World of Tanks",Earnings_by_game$Game) == TRUE),"Franchise"] <- "World of Tanks"

# Removing the dataframe unnecessary 
rm(temp_3_words)
```

```{r franchise_search_2_words, include = FALSE}

Franchise_check <- Earnings_by_game %>% filter(is.na(Franchise))
temp_2_words <- regexpr("^[[:graph:]]+\\s{1}[[:graph:]]+",Franchise_check$Game)
temp_2_words <- data.frame(words = regmatches(Franchise_check$Game,temp_2_words))
temp_2_words <- temp_2_words %>% group_by(words) %>% summarise(n=n())
temp_2_words <- temp_2_words %>% filter(n >1)
temp_2_words

# Continuing on and inserting more franchises.

Earnings_by_game[which(grepl("Day of Defeat",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Day of Defeat"
Earnings_by_game[which(grepl("Dragon Ball",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Dragon Ball"
Earnings_by_game[which(grepl("FIFA Online",Earnings_by_game$Game) == TRUE),"Franchise"] <- "FIFA Online"
Earnings_by_game[which(grepl("Forza Motorsport",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Forza"
Earnings_by_game[which(grepl("Gran Turismo",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Gran Turismo"
Earnings_by_game[which(grepl("Guitar Hero",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Guitar Hero"
Earnings_by_game[which(grepl("Halo",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Halo"
Earnings_by_game[which(grepl("Madden NFL",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Madden NFL"
Earnings_by_game[which(grepl("Mortal Kombat",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Mortal Kombat"
Earnings_by_game[which(grepl("NASCAR Thunder",Earnings_by_game$Game) == TRUE),"Franchise"] <- "NASCAR Thunder"
Earnings_by_game[which(grepl("Pokkén Tournament",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Pokkén Tournament"
Earnings_by_game[which(grepl("Project Cars",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Project Cars"
Earnings_by_game[which(grepl("Samurai Shodown",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Samurai Shodown"
Earnings_by_game[which(grepl("Track[Mm]ania",Earnings_by_game$Game) == TRUE),"Franchise"] <- "TrackMania"
Earnings_by_game[which(grepl("Unreal Tournament",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Unreal Tournament"

# Removing the dataframe unnecessary 
rm(temp_2_words)
```

```{r franchise_search_1_word, include = FALSE}

Franchise_check <- Earnings_by_game %>% filter(is.na(Franchise))
temp_1_word <- regexpr("^[[:graph:]]+",Franchise_check$Game)
temp_1_word <- data.frame(words = regmatches(Franchise_check$Game,temp_1_word))
temp_1_word <- temp_1_word %>% group_by(words) %>% summarise(n=n())
temp_1_word <- temp_1_word %>% filter(n >1)
temp_1_word

# Continuing on and inserting more franchises.

Earnings_by_game[which(grepl("Artifact",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Artifact"
Earnings_by_game[which(grepl("Asphalt ",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Asphalt" # Space is on purpose
Earnings_by_game[which(grepl("Battlefield",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Battlefield"
Earnings_by_game[which(grepl("Counter-Strike",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Counter-Strike"
Earnings_by_game[which(grepl("Doom",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Doom"
Earnings_by_game[which(grepl("Dota 2|Defense of the Ancients",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Dota"
Earnings_by_game[which(grepl("F1",Earnings_by_game$Game) == TRUE),"Franchise"] <- "F1"
Earnings_by_game[which(grepl("FIFA (?!Online)",Earnings_by_game$Game,perl = TRUE) == TRUE),"Franchise"] <- "FIFA" # As Fifa and Fifa online are different
Earnings_by_game[which(grepl("NHL",Earnings_by_game$Game) == TRUE),"Franchise"] <- "NHL"
Earnings_by_game[which(grepl("Power Rangers",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Power Rangers"
Earnings_by_game[which(grepl("Quake",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Quake"
Earnings_by_game[which(grepl("Skullgirls",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Skullgirls"
Earnings_by_game[which(grepl("Splatoon",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Splatoon"
Earnings_by_game[which(grepl("Supreme Commander",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Supreme Commander"
Earnings_by_game[which(grepl("Tetris",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Tetris"
Earnings_by_game[which(grepl("^WarCraft",Earnings_by_game$Game) == TRUE),"Franchise"] <- "WarCraft"

# Removing the dataframe unnecessary 
rm(temp_1_word)
```

```{r Last_franchise_check,include = FALSE}
Franchise_check <- Earnings_by_game %>% filter(is.na(Franchise))

Earnings_by_game[which(grepl("^Gears ",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Gears of War"
Earnings_by_game[which(grepl("^Catherine",Earnings_by_game$Game) == TRUE),"Franchise"] <- "Catherine"
Earnings_by_game[which(grepl("(?<!Auto )[Cc]hess",Earnings_by_game$Game,perl = TRUE) == TRUE),"Franchise"] <- "Chess" #Avoiding Auto Chess
Earnings_by_game[which(grepl("Injustice",Earnings_by_game$Game,perl = TRUE) == TRUE),"Franchise"] <- "Injustice"
Earnings_by_game[which(grepl("PLAYERUNKNOWN",Earnings_by_game$Game,perl = TRUE) == TRUE),"Franchise"] <- "PUBG"
Earnings_by_game[which(grepl("StarCraft",Earnings_by_game$Game,perl = TRUE) == TRUE),"Franchise"] <- "StarCraft"

```

```{r franchise_for_standalone_games, echo = TRUE}
# For the rest of the games which are not part of a franchise ill insert their title as a franchise.
##### A note #######
# It is important that once the database will be updated with more games this process will need to be redone.
####################
for (i in seq(1:nrow(Earnings_by_game)))
  {
  if (is.na(Earnings_by_game[i,"Franchise"]))
    {
    Earnings_by_game[i,"Franchise"] <- Earnings_by_game[i,"Game"]
    Earnings_by_game[i,"Stand_alone?"] <- 1
  }
}

Earnings_by_game %>% filter(is.na(Earnings_by_game$Franchise))
# All done!

# Deleating the df
rm(Franchise_check)
```
Now let's do some analysis about different franchises in the Esports scene. <br>

First, let's see which if after itroducing franchises, the list of top 10 in distribution of prize money change.

```{r top10_franchise, echo = FALSE}
# Creating df that groups by franchises
Earnings_by_franchise <- Earnings_by_game %>% 
  select(Earnings,Genre,Tournaments,Franchise) %>% 
  group_by(Franchise,Genre) %>% 
  summarise(Size = n(),Tournaments = sum(Tournaments),Earnings = sum(Earnings))

# Ordering and keeping the 10 biggest franchises
Earnings_by_franchise[order(Earnings_by_franchise$Earnings,decreasing = TRUE),][1:10,]
```

<br>
As there are no real differences between the list of top10 games and top10 franchises (except for the Call of Duty franchise in 6th placem with 15 games in the franchise), now lets see how the list of top 10 largest amount of tournaments changes after intoducing franchises.


```{r Largest_amount_of_tournaments, echo = FALSE}
# Ordering and keeping the 10 biggest franchises
Earnings_by_franchise[order(Earnings_by_franchise$Tournaments,decreasing = TRUE),][1:10,]
```
<br>
Also in hte matter of the amount of tournaments, except the Call of Duty and WarCraft franchises, the list stays about the same.




``` {r Total_franchises_per_genre,echo = FALSE}

# Creating another df, this time for the plot
Franchise_by_genre <- Earnings_by_franchise %>% 
  group_by(Genre) %>%
  summarise(Number_of_franchises = n(),Tournaments = sum(Tournaments),Earnings = sum(Earnings),Number_of_games = sum(Size),Avg_games_per_franchise = round( (sum(Size)/n()),2))

# Plotting
ggplot(data = Franchise_by_genre,aes(x = Genre,y = Number_of_franchises, fill = Genre)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = Number_of_franchises),
            vjust = -0.3,hjust = 0.55, size = 3.5) +
  theme_classic() +
  theme(axis.text= element_blank(), axis.ticks = element_blank(), legend.position = "right") + 
  labs(title = "Number of franchises per genre", y = element_blank(), x = element_blank())

```







<center><h2>This is a work in progress, there is more to come</h2></center>
<center><h3>Feel free to upvote or to give feedback :)</h3></center>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  